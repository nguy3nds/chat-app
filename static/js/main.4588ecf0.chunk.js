(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{193:function(e,t,n){},194:function(e,t,n){},280:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(38),r=n.n(i),o=(n(193),n(194),n(1)),s=n.n(o),l=n(2),d=n(289),u=n(284),j=n(285),b=n(86),p=n(106);n(195),n(168),n(281);p.a.initializeApp({apiKey:"AIzaSyCD7k-6J09mYFLqTRuGi0kiInIMRVd2XXg",authDomain:"chat-app-9711b.firebaseapp.com",projectId:"chat-app-9711b",storageBucket:"chat-app-9711b.appspot.com",messagingSenderId:"752862994948",appId:"1:752862994948:web:7df9100842156e3b500b51",measurementId:"G-6LGN6GR5JY"}),p.a.analytics();var h=p.a.auth(),m=p.a.firestore(),O=p.a,f=n(40),x=n(63),v=function(e,t){m.collection(e).add(Object(x.a)(Object(x.a)({},t),{},{createAt:O.firestore.FieldValue.serverTimestamp()}))},g=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,c=[],a=[],i=[],r=0;r<n;r++)c[r]=!1;return function e(r){for(var o=0;o<n;o++)c[o]||(c[o]=!0,a[r]=t[o],r===n-1&&i.push(a.join(" ")),e(r+1),c[o]=!1)}(0),i.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(f.a)(e),Object(f.a)(n))}),[])},y=n(12),I=d.a.Title,R=new O.auth.FacebookAuthProvider;function N(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signInWithPopup(R);case 2:t=e.sent,n=t.additionalUserInfo,c=t.user,(null===n||void 0===n?void 0:n.isNewUser)&&v("users",{displayName:c.displayName,email:c.email,photoURL:c.photoURL,uid:c.uid,providerId:n.providerId,keywords:g(c.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{children:Object(y.jsx)(u.a,{justify:"center",style:{marginTop:"50px"},children:Object(y.jsxs)(j.a,{span:8,children:[Object(y.jsx)(I,{style:{textAlign:"center"},Level:3,children:"Chat App"}),Object(y.jsx)(b.a,{style:{width:"100%"},onClick:e,children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"})]})})})}var C,w=n(49),A=n(294),k=n(50),U=n(26),V=n(39),L=n(286),S=a.a.createContext();function M(e){var t=e.children,n=Object(c.useState)({}),i=Object(U.a)(n,2),r=i[0],o=i[1],s=Object(V.f)(),l=Object(c.useState)(!0),d=Object(U.a)(l,2),u=d[0],j=d[1];return a.a.useEffect((function(){var e=h.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,c=e.uid,a=e.photoURL;return o({displayName:t,email:n,uid:c,photoURL:a}),j(!1),void s.push("/")}o({}),j(!1),s.push("/login")}));return function(){e()}}),[s]),Object(y.jsx)(S.Provider,{value:{user:r},children:u?Object(y.jsx)(L.a,{style:{position:"fixed",inset:0}}):t})}var T=k.a.div(C||(C=Object(w.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n\n  .username {\n    color: white;\n    margin-left: 5px;\n  }\n"])));function F(){var e=Object(c.useContext)(S).user,t=e.displayName,n=e.photoURL;return Object(y.jsxs)(T,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(A.a,{src:n,children:n?"":null===t||void 0===t?void 0:t.charAt(0).toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"username",children:t})]}),Object(y.jsx)(b.a,{ghost:!0,onClick:function(){h.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})}var _,E,z=n(291),D=n(296),G=function(e,t){var n=Object(c.useState)([]),a=Object(U.a)(n,2),i=a[0],r=a[1];return Object(c.useEffect)((function(){var n=m.collection(e).orderBy("createAt");if(t){if(!t.compareValue||!t.compareValue.length)return;n=n.where(t.fieldName,t.operator,t.compareValue)}var c=n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(x.a)(Object(x.a)({},e.data()),{},{id:e.id})}));return r(t),function(){c()}}))}),[e,t]),i},P=a.a.createContext();function J(e){var t=e.children,n=Object(c.useState)(!1),a=Object(U.a)(n,2),i=a[0],r=a[1],o=Object(c.useState)(!1),s=Object(U.a)(o,2),l=s[0],d=s[1],u=Object(c.useState)(""),j=Object(U.a)(u,2),b=j[0],p=j[1],h=Object(c.useContext)(S).user.uid,m=Object(c.useMemo)((function(){return{fieldName:"members",operator:"array-contains",compareValue:h}}),[h]),O=G("rooms",m),f=Object(c.useMemo)((function(){return O.find((function(e){return e.id===b}))}),[b,O]),x=Object(c.useMemo)((function(){return{fieldName:"uid",operator:"in",compareValue:null===f||void 0===f?void 0:f.members}}),[f]),v=G("users",x);return Object(y.jsx)(P.Provider,{value:{rooms:O,members:v,selectedRoom:f,isAddRoomVisible:i,setIsAddRoomVisible:r,selectedRoomId:b,setSelectedRoomId:p,isInviteMemberVisible:l,setIsInviteMemberVisible:d},children:t})}var B,H=z.a.Panel,K=Object(k.a)(H)(_||(_=Object(w.a)(["\n  &&& {\n    .ant-collapse-header,\n    p {\n      color: white;\n    }\n\n    ant-collapse-content-box {\n      padding: 0 40px;\n    }\n\n    .add-room {\n      color: white;\n      padding: 0;\n    }\n  }\n"]))),X=Object(k.a)(d.a.Link)(E||(E=Object(w.a)(["\n  display: block;\n  margin-bottom: 5px;\n  color: white;\n"])));function Y(){var e=Object(c.useContext)(P)||[],t=e.rooms,n=e.setIsAddRoomVisible,a=e.setSelectedRoomId;console.log({rooms:t});return Object(y.jsx)(z.a,{ghost:!0,defaultActiveKey:["1"],children:Object(y.jsxs)(K,{header:"Danh s\xe1ch ph\xf2ng",children:[null===t||void 0===t?void 0:t.map((function(e){return Object(y.jsx)(X,{onClick:function(){return a(e.id)},children:e.name},e.id)})),Object(y.jsx)(b.a,{type:"text",onClick:function(){n(!0)},icon:Object(y.jsx)(D.a,{}),className:"add-room",children:"Th\xeam ph\xf2ng"})]},1)})}var q=k.a.div(B||(B=Object(w.a)(["\n  background: #3f0e40;\n  color: white;\n  height: 100vh;\n"])));function W(){return Object(y.jsx)(q,{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(F,{})}),Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(Y,{})})]})})}var Q,Z,$,ee,te,ne,ce,ae=n(297),ie=n(288),re=n(82),oe=n(293),se=n(295),le=n(287),de=k.a.div(Q||(Q=Object(w.a)(["\n  margin-bottom: 10px;\n\n  .author {\n    margin-left: 5px;\n    font-weight: bold;\n  }\n\n  .date {\n    margin-left: 10px;\n    font-side: 11px;\n    color: #a7a7a7;\n  }\n\n  .content {\n    margin-left: 30px;\n  }\n"])));function ue(e){var t="";return e&&(t=(t=Object(le.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),t}function je(e){var t=e.text,n=e.displayName,c=e.createAt,a=e.photoURL;return Object(y.jsxs)(de,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(A.a,{src:a,children:"A"}),Object(y.jsx)(d.a.Text,{className:"author",children:n}),Object(y.jsx)(d.a.Text,{className:"date",children:ue(null===c||void 0===c?void 0:c.seconds)})]}),Object(y.jsx)("div",{children:Object(y.jsx)(d.a.Text,{className:"content",children:t})})]})}var be=k.a.div(Z||(Z=Object(w.a)(["\n  display: flex;\n  justify-content: space-between;\n  height: 56px;\n  padding: 0 16px;\n  align-items: center;\n  border-bottom: 1px solid rgb(230, 230, 230);\n  .header {\n    &__info {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n    &__title {\n      margin: 0;\n      font-weight: bold;\n    }\n    &__description {\n      font-size: 12px;\n    }\n  }\n"]))),pe=k.a.div($||($=Object(w.a)(["\n  display: flex;\n  align-items: center;\n"]))),he=k.a.div(ee||(ee=Object(w.a)(["\n  height: 100vh;\n"]))),me=k.a.div(te||(te=Object(w.a)(["\n  height: calc(100% - 56px);\n  display: flex;\n  flex-direction: column;\n  padding: 11px;\n  justify-content: flex-end;\n"]))),Oe=Object(k.a)(ie.a)(ne||(ne=Object(w.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2px 2px 2px 0;\n  border: 1px solid rgb(230, 230, 230);\n  border-radius: 2px;\n  .ant-form-item {\n    flex: 1;\n    margin-bottom: 0;\n  }\n"]))),fe=k.a.div(ce||(ce=Object(w.a)(["\n  max-height: 100%;\n  overflow-y: auto;\n"])));function xe(){var e=Object(c.useContext)(P),t=e.selectedRoom,n=e.members,i=e.setIsInviteMemberVisible,r=Object(c.useContext)(S).user,o=r.uid,s=r.photoURL,l=r.displayName,d=Object(c.useState)(""),u=Object(U.a)(d,2),j=u[0],p=u[1],h=ie.a.useForm(),m=Object(U.a)(h,1)[0],O=Object(c.useRef)(null),f=Object(c.useRef)(null),x=function(){v("messages",{text:j,uid:o,photoURL:s,roomId:t.id,displayName:l}),m.resetFields(["message"]),(null===O||void 0===O?void 0:O.current)&&setTimeout((function(){O.current.focus()}))},g=a.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:null===t||void 0===t?void 0:t.id}}),[null===t||void 0===t?void 0:t.id]),I=G("messages",g);return Object(c.useEffect)((function(){(null===f||void 0===f?void 0:f.current)&&(f.current.scrollTop=f.current.scrollHeight+50)}),[I]),Object(y.jsx)(he,{children:(null===t||void 0===t?void 0:t.id)?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(be,{children:[Object(y.jsxs)("div",{className:"header__info",children:[Object(y.jsx)("p",{className:"header__title",children:t.name}),Object(y.jsx)("span",{className:"header__description",children:t.description})]}),Object(y.jsxs)(pe,{children:[Object(y.jsx)(b.a,{icon:Object(y.jsx)(ae.a,{}),type:"text",onClick:function(){return i(!0)},children:"M\u1eddi"}),Object(y.jsx)(A.a.Group,{size:"small",maxCount:2,children:n.map((function(e){var t,n;return Object(y.jsx)(re.a,{title:e.displayName,children:Object(y.jsx)(A.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(y.jsxs)(me,{children:[Object(y.jsx)(fe,{ref:f,children:I.map((function(e){return Object(y.jsx)(je,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createAt:e.createAt},e.id)}))}),Object(y.jsxs)(Oe,{form:m,children:[Object(y.jsx)(ie.a.Item,{name:"message",children:Object(y.jsx)(oe.a,{ref:O,onChange:function(e){p(e.target.value)},onPressEnter:x,placeholder:"Nh\u1eadp tin nh\u1eafn...",bordered:!1,autoComplete:"off"})}),Object(y.jsx)(b.a,{type:"primary",onClick:x,children:"G\u1eedi"})]})]})]}):Object(y.jsx)(se.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:5},closable:!0})})}function ve(){return Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:6,children:Object(y.jsx)(W,{})}),Object(y.jsx)(j.a,{span:18,children:Object(y.jsx)(xe,{})})]})}var ge=n(120),ye=n(292);function Ie(){var e=Object(c.useContext)(P),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,a=Object(c.useContext)(S).user.uid,i=ie.a.useForm(),r=Object(U.a)(i,1)[0];return Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"T\u1ea1o ph\xf2ng",visible:t,onOk:function(){console.log({formData:r.getFieldValue()}),v("rooms",Object(x.a)(Object(x.a)({},r.getFieldValue()),{},{members:[a]})),r.resetFields(),n(!1)},onCancel:function(){n(!1),r.resetFields()},children:Object(y.jsxs)(ie.a,{form:r,layout:"vertical",children:[Object(y.jsx)(ie.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(y.jsx)(oe.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(y.jsx)(ie.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(y.jsx)(oe.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})}var Re=n(186),Ne=n(290),Ce=n(177);function we(e){var t=e.fetchOptions,n=e.debounceTimeout,i=void 0===n?300:n,r=Object(Re.a)(e,["fetchOptions","debounceTimeout"]),o=Object(c.useState)(!1),s=Object(U.a)(o,2),l=s[0],d=s[1],u=Object(c.useState)([]),j=Object(U.a)(u,2),b=j[0],p=j[1],h=a.a.useMemo((function(){return Object(Ce.debounce)((function(e){p([]),d(!0),t(e,r.curMembers).then((function(t){console.log({value:e,newOptions:t}),p(t),d(!1)}))}),i)}),[i,t]);return a.a.useEffect((function(){return function(){p([])}}),[]),Object(y.jsx)(Ne.a,Object(x.a)(Object(x.a)({labelInValue:!0,filterOption:!1,onSearch:h,notFoundContent:l?Object(y.jsx)(L.a,{size:"small"}):null},r),{},{children:null===b||void 0===b?void 0:b.map((function(e){var t,n;return Object(y.jsxs)(Ne.a.Option,{value:e.value,title:e.label,children:[Object(y.jsx)(A.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Ae(e,t){return ke.apply(this,arguments)}function ke(){return(ke=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.collection("users").where("keywords","array-contains",t).get().then((function(e){return console.log({"snapshot.doc":e}),e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(){var e=Object(c.useContext)(P),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,a=e.selectedRoomId,i=e.selectedRoom,r=Object(c.useState)([]),o=Object(U.a)(r,2),s=o[0],l=o[1],d=ie.a.useForm(),u=Object(U.a)(d,1)[0];return console.log({value:s}),Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){u.resetFields(),l([]),m.collection("rooms").doc(a).update({members:[].concat(Object(f.a)(i.members),Object(f.a)(s.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){u.resetFields(),l([]),n(!1)},destroyOnClose:!0,children:Object(y.jsx)(ie.a,{form:u,layout:"vertical",children:Object(y.jsx)(we,{mode:"multiple",label:"T\xean c\xe1c th\xe0nh vi\xean",value:s,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Ae,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:null===i||void 0===i?void 0:i.members})})})})}var Ve=function(){return Object(y.jsx)(ge.a,{children:Object(y.jsx)(M,{children:Object(y.jsxs)(J,{children:[Object(y.jsxs)(V.c,{children:[Object(y.jsx)(V.a,{component:N,path:"/login"}),Object(y.jsx)(V.a,{component:ve,path:"/"})]}),Object(y.jsx)(Ie,{}),Object(y.jsx)(Ue,{})]})})})};r.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(Ve,{})}),document.getElementById("root"))}},[[280,1,2]]]);
//# sourceMappingURL=main.4588ecf0.chunk.js.map